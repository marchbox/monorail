<!doctype html>
{% set is_home = page.url === '/' %}

<html lang="en">

<head>
<meta charset="utf-8">

{% set title %}{% filter trim %}
  {% if is_home %}{{title|safe}}
  {% elif page.url.startsWith('/drawings') %}{{(title + " – Drawings – " + metadata.title)|safe}}
  {% else %}{{(title + " – ")|safe if title}}{{metadata.title}}
  {% endif %}
{% endfilter %}{% endset %}
<title>{{title|safe}}</title>
<meta property="og:title" content="{{title|safe}}">

<script>document.documentElement.classList.add('js')</script>

{% set description %}{% filter trim %}
  {% if is_home %}{{metadata.description}}
  {% elif page.excerpt %}{{page.excerpt}}
  {% elif intro %}{{intro}}
  {% elif caption %}{{caption}}
  {% endif %}
{% endfilter %}{% endset %}
{% if description %}
<meta name="description" content="{{description|safe}}">
{% endif %}
<meta property="og:description" content="{{metadata.description|safe}}">

{% set canonical = metadata.host %}
{% if page.url !== '/404.html' %}
  {% set canonical = canonical + page.url|url %}
{% endif %}
<meta name="canonical" content="{{canonical}}">
<meta property="og:url" content="{{canonical}}">

<meta name="twitter:card" content="summary_large_image">
<meta property="og:type" content="website">
<meta property="og:locale" content="en">
<meta property="og:image" content="{{metadata.host}}/assets/og.png">

<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

<link rel="alternate" type="application/rss+xml" title="All articles and drawings"
    href="{{metadata.host}}/feeds/all.xml">
<link rel="alternate" type="application/rss+xml" title="All articles"
    href="{{metadata.host}}/feeds/articles.xml">
<link rel="alternate" type="application/rss+xml" title="All drawings"
    href="{{metadata.host}}/feeds/drawings.xml">
<link rel="icon" href="{{'/assets/favicon.png'|url}}">
<link rel="icon" href="{{'/assets/favicon.svg'|url}}" type="image/svg+xml">
<link rel="stylesheet" href="{{fonts.google|getFontUrl|safe}}">
<link rel="stylesheet" href="{{'/css/default.css?[css-version]'|url}}">
</head>

<body>

<header class="header">
  <a class="logo" href="{{'/'|url}}" title="Return to the entrance">
    <div class="logo-img" aria-label="marchbox.com’s logo" role="img">
      {% include '_src/svg/logo.svg' %}
    </div>
  </a>
  <nav class="nav" is="land-monorail" aria-label="main navigation">
    <div class="monorail-station" role="none">
      <div class="monorail-train" role="none">
        <div class="monorail-engine" aria-hidden="true">
          {% include '_src/svg/monorail-engine-head.svg' %}
        </div>
        {% for entry in collections.all|eleventyNavigation %}
          {% set isCurrent = entry.url == page.url %}
          {% set isActive = entry.url == page.url or entry|isParent(page) %}
          <a href="{{entry.url|url}}"{% if isCurrent %} aria-current="page"{% endif %}
              class="monorail-car{% if isActive %} active{% endif %}">
            <span role="none">{{entry.title}}</span>
          </a>
        {% endfor %}
        <div class="monorail-engine" aria-hidden="true">
          {% include '_src/svg/monorail-engine-tail.svg' %}
        </div>
      </div>
    </div>
  </nav>
</header>

<main>{{content|safe}}</main>

<footer class="footer">
  <div class="fenced" role="none">
    <ul class="footer-links">
      <li><a href="{{'/about/#subscribe'|url}}">Subscribe</a></li>
      <li><a href="{{'/about/#contact'|url}}">Contact</a></li>
      <li><a href="https://twitter.com/marchbox">@marchbox</a></li>
    </ul>
    <p>©{% copyrightYear %} <a href="{{'/about'|url}}">Zacky Ma</a></p>
  </div>
  <land-sidewalks />
</footer>

<script src="{{'/js/main.js?[js-version]'|url}}" async></script>
</body>

</html>
